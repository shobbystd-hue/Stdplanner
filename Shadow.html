<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE SYSTEM: OVERHAUL</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&display=swap');
        :root { --sys-cyan: #38bdf8; --sys-blue: #1d4ed8; }
        body { font-family: 'Orbitron', sans-serif; background: #020617; color: #fff; letter-spacing: 1px; text-transform: uppercase; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }
        
        .system-text { color: var(--sys-cyan); text-shadow: 0 0 8px rgba(56, 189, 248, 0.5); }
        .system-border { border: 1px solid var(--sys-cyan); background: rgba(15, 23, 42, 0.9); }
        
        /* Tab Management */
        .view-panel { display: none; flex-grow: 1; padding: 20px; overflow-y: auto; }
        .active-view { display: flex; flex-direction: column; }
        
        /* Bottom Navigation */
        .nav-bar { background: rgba(15, 23, 42, 0.95); border-top: 1px solid #1e293b; display: flex; justify-content: space-around; padding: 10px 0; }
        .nav-item { font-size: 8px; opacity: 0.4; transition: 0.3s; display: flex; flex-direction: column; align-items: center; gap: 4px; }
        .nav-active { opacity: 1; color: var(--sys-cyan); text-shadow: 0 0 5px var(--sys-cyan); }
        
        /* Graph Styling */
        #graph-canvas { width: 100%; height: 200px; background: rgba(0,0,0,0.3); }

        input[type="checkbox"] { width: 22px; height: 22px; accent-color: var(--sys-cyan); }
        input[type="text"] { background: transparent; border-bottom: 1px solid #1e293b; color: white; width: 100%; outline: none; font-size: 11px; padding: 5px 0; }
    </style>
</head>
<body onclick="initAudio()">

    <header class="p-5 border-b border-sky-900 flex justify-between items-center bg-slate-950">
        <div>
            <h1 class="text-[9px] system-text">[ HUNTER_ID ]</h1>
            <h2 class="text-lg font-black italic tracking-tighter" id="job-title">S. MONARCH</h2>
        </div>
        <div class="text-right">
            <p class="text-[8px] opacity-60">LVL</p>
            <p id="lvl-num" class="system-text text-xl font-black">01</p>
        </div>
    </header>

    <main id="view-quests" class="view-panel active-view">
        <h3 class="text-[10px] system-text mb-6 tracking-[3px]">[ ACTIVE_MISSIONS ]</h3>
        <div class="space-y-6">
            <div class="bg-slate-900/50 p-4 border-l-4 border-sky-500 shadow-lg">
                <p class="text-[8px] text-sky-400 mb-3">WORK_SECTOR</p>
                <div class="flex gap-4 items-center mb-4"><input type="checkbox" id="wc1" onchange="completeQuest(this)"><input type="text" id="wt1" placeholder="ENTER MISSION..." oninput="saveData()"></div>
                <div class="flex gap-4 items-center"><input type="checkbox" id="wc2" onchange="completeQuest(this)"><input type="text" id="wt2" placeholder="ENTER MISSION..." oninput="saveData()"></div>
            </div>
            <div class="bg-slate-900/50 p-4 border-l-4 border-indigo-500 shadow-lg">
                <p class="text-[8px] text-indigo-400 mb-3">STUDY_SECTOR</p>
                <div class="flex gap-4 items-center mb-4"><input type="checkbox" id="sc1" onchange="completeQuest(this)"><input type="text" id="st1" placeholder="ENTER MISSION..." oninput="saveData()"></div>
            </div>
        </div>
    </main>

    <main id="view-gate" class="view-panel">
        <div class="flex flex-col items-center justify-center h-full">
            <div class="text-[9px] mb-2 tracking-[5px] opacity-60">[ GATE_CLOSURE_TIME ]</div>
            <div id="timer" class="text-7xl font-black mb-10 italic tracking-tighter">25:00</div>
            
            <div class="grid grid-cols-2 gap-4 w-full max-w-sm">
                <button onclick="startTimer(1500)" class="system-border py-4 text-[10px] font-black hover:bg-sky-900">START_RAID</button>
                <button onclick="resetTimer()" class="system-border py-4 text-[10px] font-black border-slate-700 opacity-50">CANCEL</button>
            </div>
            
            <div class="mt-10 p-4 system-border text-[9px] w-full text-center">
                [ STATUS: <span id="raid-status" class="text-sky-500">IDLE</span> ]
            </div>
        </div>
    </main>

    <main id="view-stats" class="view-panel">
        <h3 class="text-[10px] system-text mb-6 tracking-[3px]">[ GROWTH_ANALYTICS ]</h3>
        <div class="system-border p-4 mb-6">
            <canvas id="graph-canvas"></canvas>
        </div>
        <div class="grid grid-cols-2 gap-4">
            <div class="bg-slate-900/80 p-4 border border-slate-800">
                <p class="text-[8px] opacity-50 mb-1">TOTAL_MANA</p>
                <p id="mana-display" class="text-lg font-black system-text">0</p>
            </div>
            <div class="bg-slate-900/80 p-4 border border-slate-800">
                <p class="text-[8px] opacity-50 mb-1">CURRENT_RANK</p>
                <p id="rank-display" class="text-lg font-black text-rose-500">E</p>
            </div>
        </div>
    </main>

    <nav class="nav-bar">
        <button onclick="switchTab('quests')" id="nav-quests" class="nav-item nav-active">
            <span>â–£</span>
            <span>QUESTS</span>
        </button>
        <button onclick="switchTab('gate')" id="nav-gate" class="nav-item">
            <span>â—ˆ</span>
            <span>GATE</span>
        </button>
        <button onclick="switchTab('stats')" id="nav-stats" class="nav-item">
            <span>ðŸ“ˆ</span>
            <span>GROWTH</span>
        </button>
    </nav>

    <script>
        let countdown, audioCtx;
        let mana = parseInt(localStorage.getItem('mana_v16')) || 0;
        let logs = JSON.parse(localStorage.getItem('logs_v16')) || [0,0,0,0,0,0,0];

        function initAudio() { if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)(); }

        function switchTab(tabId) {
            document.querySelectorAll('.view-panel').forEach(p => p.classList.remove('active-view'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('nav-active'));
            document.getElementById('view-' + tabId).classList.add('active-view');
            document.getElementById('nav-' + tabId).classList.add('nav-active');
            if(tabId === 'stats') drawGraph();
            playBeep(800, 0.05);
        }

        function saveData() {
            const data = {};
            document.querySelectorAll('input[type="text"]').forEach(i => data[i.id] = i.value);
            document.querySelectorAll('input[type="checkbox"]').forEach(i => data[i.id] = i.checked);
            localStorage.setItem('loadout_v16', JSON.stringify(data));
            localStorage.setItem('mana_v16', mana);
            updateSystem();
        }

        function updateSystem() {
            document.getElementById('mana-display').innerText = mana.toLocaleString();
